
<link rel="import" href="../lrn-gitbook-gitbook-icon/lrn-gitbook-gitbook-icon.html">

<dom-module id="lrn-gitbook-sync">
  <template>
    <style>
      :host {
        display: block;
        padding: 3em;
      }

      .wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .wrapper > * {
        margin: 0 1em;
      }

      .sync__title {
        text-align: center;
      }

      #sync-button {
        color: inherit;
        font-size: 2.5em;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-width: 4em;
      }
      #sync-button > *:not(:first-child) {
        margin-top: 1em; 
      }
      .sync-icon {
        width: 1em;
        height: 1em;
      }
      :host[is-syncing] .sync-icon {
        animation: rotate 1s infinite linear;
      }
      .sync-status {
        text-transform: uppercase;
        padding: .3em .5em;
        background: rgba(green, 0.8);
      }

      lrn-gitbook-gitbook-icon {
        max-width: 10em;
      }

      lrn-icon.icons {
        width: 4.5em;
        height: 4.5em;
        opacity: .8;
      }

      @keyframes rotating {
        from {
          transform: rotate(-359deg);
        }
        to {
          transform: rotate(1deg);
        }
      }
    </style>

    <h2 class="sync__title">[[title]]</h2>

    <div class="wrapper">
      <lrn-icon class="icons" icon="content-outline"></lrn-icon>
      <a raised id="sync-button" tabindex="1">
        <iron-icon class="sync-icon" icon="[[icon]]"></iron-icon>
        <div class="sync-status">
          [[status]]
        </div>
      </a>
      <lrn-gitbook-gitbook-icon></lrn-gitbook-gitbook-icon>
    </div>
    
  </template>
  <script>
    Polymer({
      is: 'lrn-gitbook-sync',
      properties: {
        isSyncing: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },
        status: {
          type: String,
          value: 'up-to-date',
          notify: true
        },
        title: String,
        icon: String
      },
      observers: [
        '_statusChange(status)'
      ],
      ready: function() {
        var root = this;
        root.$$('#sync-button').addEventListener('click', function(e) {
          if (root.status !== 'up-to-date') {
            root.fire('gitbook-sync-clicked');
          }
        });
      },
      _statusChange: function(status) {
        var root = this;
        root.fire('gitbook-status-change', {status: status});
        // set the icon based on the status
        if (status === 'up-to-date') {
          this.icon = 'icons:check';
        }
        else {
          this.icon = 'icons:cached';
        }
      }
    });
  </script>
</dom-module>
